<!DOCTYPE html>
<html class="html" lang="en-US">
 <head>

  <script type="text/javascript">
   if(typeof Muse == "undefined") window.Muse = {}; window.Muse.assets = {"required":["jquery-1.8.3.min.js", "museutils.js", "jquery.watch.js", "jquery.musemenu.js", "sas-macros.css"], "outOfDate":[]};
</script>
  
  <meta http-equiv="Content-type" content="text/html;charset=UTF-8"/>
  <meta name="generator" content="2014.1.1.276"/>
  <title>SAS Macros</title>
  <!-- CSS -->
  <link rel="stylesheet" type="text/css" href="css/site_global.css?534370344"/>
  <link rel="stylesheet" type="text/css" href="css/master_a-master.css?3949364547"/>
  <link rel="stylesheet" type="text/css" href="css/sas-macros.css?74235035" id="pagesheet"/>
  <!--[if lt IE 9]>
  <link rel="stylesheet" type="text/css" href="css/iefonts_sas-macros.css?3914916929"/>
  <![endif]-->
  <!-- Other scripts -->
  <script type="text/javascript">
   document.documentElement.className += ' js';
var __adobewebfontsappname__ = "muse";
</script>
  <!-- JS includes -->
  <script type="text/javascript">
   document.write('\x3Cscript src="' + (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//webfonts.creativecloud.com/open-sans:n3,n4,n6,i6:all.js" type="text/javascript">\x3C/script>');
</script>
  <!--[if lt IE 9]>
  <script src="scripts/html5shiv.js?4241844378" type="text/javascript"></script>
  <![endif]-->
   </head>
 <body>

  <div class="clearfix" id="page"><!-- group -->
   <div class="clearfix grpelem" id="ppu77"><!-- column -->
    <div class="clearfix colelem" id="pu77"><!-- group -->
     <div class="browser_width grpelem" id="u77-bw">
      <div id="u77"><!-- group -->
       <div class="clearfix" id="u77_align_to_page">
        <div class="clearfix grpelem" id="u83-7"><!-- content -->
         <p id="u83-5"><span id="u83-3">Risk Prediction Modeling<br/></span><span id="u83-4">Division of Preventive Medicine</span></p>
        </div>
       </div>
      </div>
     </div>
     <div class="browser_width grpelem" id="u90-bw">
      <div id="u90"><!-- simple frame --></div>
     </div>
     <div class="clip_frame grpelem" id="u564"><!-- image -->
      <img class="block" id="u564_img" src="images/cook-image1.jpg" alt="" width="230" height="168"/>
     </div>
    </div>
    <div class="clearfix colelem" id="ppmenuu127"><!-- group -->
     <div class="clearfix grpelem" id="pmenuu127"><!-- column -->
      <nav class="MenuBar clearfix colelem" id="menuu127"><!-- vertical box -->
       <div class="MenuItemContainer clearfix colelem" id="u128"><!-- horizontal box -->
        <a class="nonblock nontext MenuItem MenuItemWithSubMenu clearfix grpelem" id="u129" href="index.html"><!-- horizontal box --><div class="MenuItemLabel clearfix grpelem" id="u131-4"><!-- content --><p>Home</p></div></a>
       </div>
       <div class="MenuItemContainer clearfix colelem" id="u143"><!-- horizontal box -->
        <a class="nonblock nontext MenuItem MenuItemWithSubMenu MuseMenuActive clearfix grpelem" id="u144" href="sas-macros.html"><!-- horizontal box --><div class="MenuItemLabel clearfix grpelem" id="u145-4"><!-- content --><p>SAS Macros</p></div></a>
       </div>
       <div class="MenuItemContainer clearfix colelem" id="u150"><!-- horizontal box -->
        <a class="nonblock nontext MenuItem MenuItemWithSubMenu clearfix grpelem" id="u151" href="r-code.html"><!-- horizontal box --><div class="MenuItemLabel clearfix grpelem" id="u154-4"><!-- content --><p>R Code</p></div></a>
       </div>
       <div class="MenuItemContainer clearfix colelem" id="u157"><!-- horizontal box -->
        <a class="nonblock nontext MenuItem MenuItemWithSubMenu clearfix grpelem" id="u158" href="publications-list.html"><!-- horizontal box --><div class="MenuItemLabel clearfix grpelem" id="u159-4"><!-- content --><p>Publications List</p></div></a>
       </div>
       <div class="MenuItemContainer clearfix colelem" id="u427"><!-- horizontal box -->
        <a class="nonblock nontext MenuItem MenuItemWithSubMenu clearfix grpelem" id="u430" href="our-team.html"><!-- horizontal box --><div class="MenuItemLabel clearfix grpelem" id="u433-4"><!-- content --><p>Our Team</p></div></a>
       </div>
       <div class="MenuItemContainer clearfix colelem" id="u507"><!-- horizontal box -->
        <a class="nonblock nontext MenuItem MenuItemWithSubMenu clearfix grpelem" id="u508" href="contact-us.html"><!-- horizontal box --><div class="MenuItemLabel clearfix grpelem" id="u510-4"><!-- content --><p>Contact Us</p></div></a>
       </div>
      </nav>
      <div class="clearfix colelem" id="u594-3"><!-- content -->
       <p>&nbsp;</p>
      </div>
      <div class="clearfix colelem" id="u595-3"><!-- content -->
       <p>&nbsp;</p>
      </div>
      <div class="clearfix colelem" id="u600-3"><!-- content -->
       <p>&nbsp;</p>
      </div>
     </div>
     <div class="clearfix grpelem" id="u168-254"><!-- content -->
      <h1 class="head_30">SAS Macros</h1>
      <p class="body">&nbsp;</p>
      <p class="body-13">These macros are provided for general use as is. Although they have been debugged and validated, they are provided with no guarantee of performance in other data.</p>
      <p class="body">&nbsp;</p>
      <h2 class="head-18-semi-greeen">Binary Outcomes</h2>
      <p class="body-13">All macros assume that predicted probabilities have been saved for each model of interest, such as through logistic regression or some other method. Note that the predicted probabilities can be from any type of model and do not need to be nested. The bootstrap program that adjusts for optimism is the only exception since it compares nested models.</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-13">The following inputs are required in all macros:</p>
      <p class="body-13">DSNAME = data set name</p>
      <p class="body-13">DETAIL = 2 for detailed output, 1 for limited output, 0 for no output report (such as for simulations or bootstrapping)</p>
      <p class="body-13">STATVAR or OUTC = binary outcome variable</p>
      <p class="body-13">PROB = predicted probability</p>
      <p class="body-13">Macros that compare two models replace the latter with</p>
      <p class="body-13">PROB1 = predicted probability for Model 1</p>
      <p class="body-13">PROB2 = predicted probability for Model 2</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-30">Hosmer&#45;Lemeshow goodness of fit test</p>
      <p class="body-13"><a class="nonblock" href="assets/hlcalibmacs.v1.sas">hlcalibmacs.v1.sas </a>– Includes macros:</p>
      <p class="body-13">%calibhl – For Hosmer&#45;Lemeshow goodness&#45;of&#45;fit test across deciles of risk</p>
      <p class="body-13">%calhlcat – For Hosmer&#45;Lemeshow goodness&#45;of&#45;fit test across user&#45;specified categories of risk</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-41">C&#45;statistics or area under the ROC curve</p>
      <p class="body-13"><a class="nonblock" href="assets/cstatmacs.v1.sas">cstatmacs.v1.sas</a>&nbsp;– Includes macros:</p>
      <p class="body-13">%cstat – C&#45;statistic from Proc Freq</p>
      <p class="body-13">%ctest – Tests difference in c&#45;statistics (based on Rosner &amp; Glynn, Biometrics 2009)</p>
      <p class="body-13">%corrs – Computes SE of difference in c&#45;statistics, used within %ctest</p>
      <p class="body-13">%delong – Computes DeLong test of difference in c’s (Biometrics 1988) using Proc Logistic</p>
      <p class="body-13">(Note that the tests of difference in c’s should not be used to test nested models in the model development data – see Demler, StatMed 2012)</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-58">Reclassification Statistics</p>
      <p class="body-13"><a class="nonblock" href="assets/reclass.macros.v4.sas">reclass.macros.v4.sas</a>&nbsp;– Includes macros:</p>
      <p class="body-13">%reclass – for reclassification calibration test</p>
      <p class="body-13">%nricat – for categorical NRI</p>
      <p class="body-13">%idimacro – for IDI</p>
      <p class="body-13">%contnri – for continuous NRI</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-73">Conditional NRI for subcategories of intermediate risk</p>
      <p class="body-13">(Includes correction for null – see Paynter, MDM 2013)</p>
      <p class="body-13"><a class="nonblock" href="assets/cnrimacro.v1.sas">cnrimacro.v1.sas </a>– Includes macro:</p>
      <p class="body-13">%cnricat</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-84">Weighted Reclassification Statistics</p>
      <p class="body-13"><a class="nonblock" href="assets/reclass.wtmacs.v2.sas">reclass.wtmacs.v2.sas</a>&nbsp;– Includes macros:</p>
      <p class="body-13">%reclasswt – for weighted reclassification calibration test</p>
      <p class="body-13">%nriwt – for weighted categorical NRI</p>
      <p class="body-13">%idiwt – for weighted IDI</p>
      <p class="body-13">%contnriwt – for weighted continuous NRI</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-99">Bootstrap programs to compute standard error</p>
      <p class="body-13"><a class="nonblock" href="assets/bootitmacro.v2.sas">bootitmacro.v2.sas</a>&nbsp;– Includes macro:</p>
      <p class="body-13">%bootit – to compute SE and CI for the reclassification statistics using bootstraps (calls macros in reclass.macros.v4.sas)</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-108">Bootstrap programs to adjust for optimism</p>
      <p class="body-13"><a class="nonblock" href="assets/bootoptmacro.v2.sas">bootoptmacro.v2.sas</a>&nbsp;– Includes macro:</p>
      <p class="body-13">%bootopt – to adjust for optimism in estimates of fit using bootstraps when adding new variables to a base model (calls macros in reclass.macros.v4.sas)</p>
      <p class="body">&nbsp;</p>
      <p class="body">&nbsp;</p>
      <h2 class="head-18-semi-greeen">Survival Outcomes</h2>
      <p class="body-13">All macros assume that predicted probabilities at time T have been saved for each model of interest, such as through Cox regression or some other method. For program code to do this in SAS, see the program savesurv_T.sas below.&nbsp; Note that the predicted probabilities can be from any type of model and do not need to be nested. Observed probabilities are based on nonparametric estimates. The bootstrap program that adjusts for optimism is the only exception since it compares nested models.</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-123">The following inputs are required in all macros:</p>
      <p class="body-13">DSNAME = data set name</p>
      <p class="body-13">DETAIL = 2 for detailed output, 1 for limited output, 0 for no output report (such as for simulations or bootstrapping)</p>
      <p class="body-13">STATVAR or OUTC = outcome variable (1=event, 0=censored)</p>
      <p class="body-13">PYRS = person&#45;time to event or censoring</p>
      <p class="body-13">T = Time of interest for prediction</p>
      <p class="body-13">PROB = predicted probability at time T</p>
      <p class="body-13">Macros that compare two models replace the latter with</p>
      <p class="body-13">PROB1 = predicted probability at time T for Model 1</p>
      <p class="body-13">PROB2 = predicted probability at time T for Model 2</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-144">D’Agostino&#45;Nam test of goodness&#45;of&#45;fit</p>
      <p class="body-13">From D’Agostino and Nam, Handbook of Statistics, 2004. Note that this should only be used in low&#45;censoring situations.</p>
      <p class="body-13"><a class="nonblock" href="assets/surv_calibmacs.v2.sas">surv_calibmacs.v2.sas</a>&nbsp;– Includes macros:</p>
      <p class="body-13">%surv_calibhl – for decile categories</p>
      <p class="body-13">%surv_calibr2 – for user&#45;specified categories of risk</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-157">C&#45;statistics for survival data</p>
      <p class="body-13">Based on Pencina et al, StatMed 2004. Note that these can take a long time to run.</p>
      <p class="body-13"><a class="nonblock" href="assets/survcmacs.v1.sas">survcmacs.v1.sas</a>&nbsp;– Includes macros:</p>
      <p class="body-13">%predc – computes Noether and wide confidence intervals</p>
      <p class="body-13">%predc_simp – computes wide CIs only (eg., useful for bootstrapping)</p>
      <p class="body-13">%predcwt – computes Noether and wide CIs, including weights</p>
      <p class="body-13">%predcwt_simp – computes wide CIs only with weights</p>
      <p class="body-13">%predc_big – computes wide CIs only; use for large datasets (subsets for efficiency)</p>
      <p class="body-13">%predcwt_big – computes wide CIs only with weights; use for large datasets</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-178">Reclassification Statistics for survival data</p>
      <p class="body-13"><a class="nonblock" href="assets/survmacs.v3.sas">survmacs.v3.sas</a>&nbsp;– Includes macros:</p>
      <p class="body-13">%surv_reclass – for reclassification calibration test (for low&#45;censoring situations)</p>
      <p class="body-13">%surv_nri – for categorical NRI</p>
      <p class="body-13">%surv_idi – for IDI</p>
      <p class="body-13">%surv_contnricat – for continuous NRI</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-193">Weighted Reclassification Statistics for survival data</p>
      <p class="body-13"><a class="nonblock" href="assets/survwtmacs.v2.sas">survwtmacs.v2.sas </a>– Includes macros:</p>
      <p class="body-13">%surv_reclasswt – for reclassification calibration test</p>
      <p class="body-13">%surv_nriwt – for categorical NRI</p>
      <p class="body-13">%surv_idiwt – for IDI</p>
      <p class="body-13">%surv_contnriwt – for continuous NRI</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-208">Bootstrap programs to compute standard errors in survival data</p>
      <p class="body-13">(Note: Bootstrap programs are not available for weighted samples, since the sampling can depend on the weighting structure.)</p>
      <p class="body-13"><a class="nonblock" href="assets/bootitsmacro.v2.sas">bootitsmacro.v2.sas</a>&nbsp;– Includes macros for reclassification statistics:</p>
      <p class="body-13">%bootits – to compute SE and CI for the survival reclassification statistics using bootstraps (calls macros in survmacs.sas)</p>
      <p class="body-13">&nbsp;</p>
      <p class="body-13"><a class="nonblock" href="assets/bootscmacro.v1.sas">bootscmacro.v1.sas </a>– Includes macro for c&#45;index for survival data:</p>
      <p class="body-13">%bootitsc – to compute SE and CI for the survival c&#45;index using bootstraps (calls macros in survcmacs.sas). Note: takes a long time to run.</p>
      <p class="body-13">&nbsp;</p>
      <p class="body-13"><a class="nonblock" href="assets/bootsurvcmac.v2.sas">bootsurvcmac.v2.sas</a>&nbsp;– Includes macros for both reclassification statistics and c&#45;index:</p>
      <p class="body-13">%bootalls – to compute SE and CI for the survival reclassification statistics and c&#45;index using bootstraps (calls macros in survmacs.sas and survcmacs.sas). Note: takes a long time to run.</p>
      <p class="body">&nbsp;</p>
      <p class="body-italic-semi-13" id="u168-233">Bootstrap programs to adjust for optimism for survival data</p>
      <p class="body-13"><a class="nonblock" href="assets/bootsurvoptmac.v2.sas">bootsurvoptmac.v2.sas</a>&nbsp;– Includes macro:</p>
      <p class="body-13">%bootsurvopt – to adjust for optimism in estimates of fit using bootstraps when adding new variables to a base model for survival data (calls macros in survmacs.sas).</p>
      <p class="body">&nbsp;</p>
      <p class="body-13"><a class="nonblock" href="assets/bootsurvcopt.v1.sas">bootsurvcopt.v1.sas</a>&nbsp;– Includes macro:</p>
      <p class="body-13">%bootsurvcopt – to adjust for optimism in c-index (only) using bootstraps when adding new variables to a base model for survival data (calls macros in survcmacs.sas).</p>
      <p class="body">&nbsp;</p>
      <p class="body">&nbsp;</p>
      <h2 class="head-18-semi-greeen">Other programs</h2>
      <p class="body-13"><a class="nonblock" href="assets/savesurv_t.sas">savesurv_T.sas</a>&nbsp;– Code to save predicted probabilities at time T from a Cox model</p>
      <p class="body-13"><a class="nonblock" href="assets/risk_score_code.sas">risk_score_code.sas </a>– Includes code to compute the AHA/ACC, ATP III, and Reynolds risk scores</p>
      <p class="body">&nbsp;</p>
     </div>
    </div>
   </div>
   <div class="verticalspacer"></div>
   <div class="clip_frame grpelem" id="u182"><!-- image -->
    <img class="block" id="u182_img" src="images/logo.gif" alt="" width="168" height="61"/>
   </div>
   <div class="clearfix grpelem" id="u100"><!-- group -->
    <div class="clearfix grpelem" id="u101-10"><!-- content -->
     <p id="u101-2">Brigham &amp; Women’s Hospital</p>
     <p id="u101-4">Division of Preventive Medicine&nbsp; | 900 Commonwealth Avenue East&nbsp; |&nbsp; Boston, MA 02215&nbsp; | 617.278.0796</p>
     <p id="u101-8">email: <a class="nonblock" href="mailto:ncook@rics.bwh.harvard.edu">ncook@rics.bwh.harvard.edu</a></p>
    </div>
   </div>
  </div>
  <!-- JS includes -->
  <script type="text/javascript">
   if (document.location.protocol != 'https:') document.write('\x3Cscript src="http://musecdn2.businesscatalyst.com/scripts/4.0/jquery-1.8.3.min.js" type="text/javascript">\x3C/script>');
</script>
  <script type="text/javascript">
   window.jQuery || document.write('\x3Cscript src="scripts/jquery-1.8.3.min.js" type="text/javascript">\x3C/script>');
</script>
  <script src="scripts/museutils.js?4136605575" type="text/javascript"></script>
  <script src="scripts/jquery.watch.js?172956391" type="text/javascript"></script>
  <script src="scripts/jquery.musemenu.js?4009181048" type="text/javascript"></script>
  <!-- Other scripts -->
  <script type="text/javascript">
   $(document).ready(function() { try {
(function(){var a={},b=function(a){if(a.match(/^rgb/))return a=a.replace(/\s+/g,"").match(/([\d\,]+)/gi)[0].split(","),(parseInt(a[0])<<16)+(parseInt(a[1])<<8)+parseInt(a[2]);if(a.match(/^\#/))return parseInt(a.substr(1),16);return 0};(function(){$('link[type="text/css"]').each(function(){var b=($(this).attr("href")||"").match(/\/?css\/([\w\-]+\.css)\?(\d+)/);b&&b[1]&&b[2]&&(a[b[1]]=b[2])})})();(function(){$("body").append('<div class="version" style="display:none; width:1px; height:1px;"></div>');
for(var c=$(".version"),d=0;d<Muse.assets.required.length;){var f=Muse.assets.required[d],g=f.match(/([\w\-\.]+)\.(\w+)$/),k=g&&g[1]?g[1]:null,g=g&&g[2]?g[2]:null;switch(g.toLowerCase()){case "css":k=k.replace(/\W/gi,"_").replace(/^([^a-z])/gi,"_$1");c.addClass(k);var g=b(c.css("color")),h=b(c.css("background-color"));g!=0||h!=0?(Muse.assets.required.splice(d,1),"undefined"!=typeof a[f]&&(g!=a[f]>>>24||h!=(a[f]&16777215))&&Muse.assets.outOfDate.push(f)):d++;c.removeClass(k);break;case "js":k.match(/^jquery-[\d\.]+/gi)&&
typeof $!="undefined"?Muse.assets.required.splice(d,1):d++;break;default:throw Error("Unsupported file type: "+g);}}c.remove();if(Muse.assets.outOfDate.length||Muse.assets.required.length)c="Some files on the server may be missing or incorrect. Clear browser cache and try again. If the problem persists please contact website author.",(d=location&&location.search&&location.search.match&&location.search.match(/muse_debug/gi))&&Muse.assets.outOfDate.length&&(c+="\nOut of date: "+Muse.assets.outOfDate.join(",")),d&&Muse.assets.required.length&&(c+="\nMissing: "+Muse.assets.required.join(",")),alert(c)})()})();/* body */
Muse.Utils.transformMarkupToFixBrowserProblemsPreInit();/* body */
Muse.Utils.prepHyperlinks(true);/* body */
Muse.Utils.resizeHeight()/* resize height */
Muse.Utils.initWidget('.MenuBar', function(elem) { return $(elem).museMenu(); });/* unifiedNavBar */
Muse.Utils.fullPage('#page');/* 100% height page */
Muse.Utils.showWidgetsWhenReady();/* body */
Muse.Utils.transformMarkupToFixBrowserProblems();/* body */
} catch(e) { if (e && 'function' == typeof e.notify) e.notify(); else Muse.Assert.fail('Error calling selector function:' + e); }});
</script>
   </body>
</html>
